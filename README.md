# ３値分類プログラム

このリポジトリは領域検出を行う際に用いる３値分類モデルを作成するためのプログラムが格納されています。  

## 実行環境について

本リポジトリのプログラムにおける実行環境は以下の通りです。

|項目|使用|
|:-|:-|
|OS|Ubuntu Desktop 20.04 LTS (64bit) |
|NVIDIA Driver Version|525.116.04|
|cuda|11.2|
|cuDNN|8.9.5|

また、使用言語およびライブラリは以下の通りです。

|項目|使用|
|:-|:-|
|言語|Python 3.10.5|
|ライブラリ|tensorflow 2.10.0<br>keras 2.10.0|

## 各ディレクトリ、プログラムの説明

### data_setディレクトリ

モデルの学習に用いるデータ（trainディレクトリ）、モデルの検証のために用いるデータ（testディレクトリ）を格納する場所。

### fontディレクトリ

モデルの学習時に出力されるグラフ（エポック数-損失関数など）の表示に用いられるフォントファイルの格納場所。

### modelディレクトリ

学習によって作成された重みファイル（.h5形式）の保存先。

### np_fileディレクトリ

後述するプログラムで作成するnumpy配列が格納されたファイル（.npyファイル）の保存先。

### 各プログラム
|プログラム名|説明|
|:-|:-|
|convert_npy.py|data_setディレクトリに格納された画像データを事前学習済みであるVGG19を用いてベクトル（numpy配列）化し、それらを.npy形式のファイル（numpy独自のバイナリファイル）として出力するためのプログラム。|
|training_param.py|convert_npy.pyでベクトル化したデータを用いて、３値分類タスクを行うモデルを作成するプログラム。|
|predict.py|training_param.pyによって作成されたモデル（.h5ファイル）の精度を検証するためのプログラム。|

## プログラムの実行手順
プログラムは次の手順で実行します。

1. convert_npy.pyにて画像データをnpyファイルに変換する。変換については訓練データ、テストデータ共に行っておく。
2. training_param.pyにて1.で作成した訓練データのnpyファイルを読み込み学習し，３値分類モデルの作成を行う。
3. 2.で作成されたモデルの性能について、predict.pyを実行して精度検証を行う。精度検証では1.で作成したテストデータのnpyファイルを用いる。

## 学習時の注意点
後の領域判定プログラムの使用上、学習データに用いる画像のサイズは元画像の約数にする必要があります。例えば、元の結晶画像のサイズは2048×2048ですが、本プログラムでは元の結晶画像から32×32サイズに切り取った画像を用いるようにしています。  
  
また、学習データ、テストデータ用の画像を作成する際は[こちら](https://github.com/0gawa0/Gazoukiridasikun)をご利用ください。